## Test 0208: Conventional file mmap read/write

/usr/local/bin/fio
Check conventional file mmap write
/dev/vdb: 1572864 512-byte sectors (0 GiB)
  Host-managed device
  12 zones of 131072 512-byte sectors (64 MiB)
  6 conventional zones, 6 sequential zones
  0 read-only zones, 0 offline zones
Format:
  11 usable zones
  Aggregate conventional zones: disabled
  File UID: 0
  File GID: 0
  File access permissions: 640
  FS UUID: 9fd390a4-b798-4da6-888c-677f1e2b1bd7
Resetting sequential zones
Writing super block
cnv_mmapwr: (g=0): rw=randwrite, bs=(R) 256KiB-256KiB, (W) 256KiB-256KiB, (T) 256KiB-256KiB, ioengine=mmap, iodepth=1
fio-3.32
Starting 1 process

cnv_mmapwr: (groupid=0, jobs=1): err= 0: pid=3412: Mon Jan 16 20:43:11 2023
  read: IOPS=2000, BW=500MiB/s (524MB/s)(64.0MiB/128msec)
    clat (nsec): min=24062, max=63710, avg=27147.95, stdev=4003.18
     lat (nsec): min=24091, max=63738, avg=27180.36, stdev=4009.17
    clat percentiles (nsec):
     |  1.00th=[24192],  5.00th=[24704], 10.00th=[24960], 20.00th=[25216],
     | 30.00th=[25472], 40.00th=[25728], 50.00th=[25984], 60.00th=[26496],
     | 70.00th=[27008], 80.00th=[27776], 90.00th=[30592], 95.00th=[33536],
     | 99.00th=[43264], 99.50th=[52480], 99.90th=[63744], 99.95th=[63744],
     | 99.99th=[63744]
  write: IOPS=175, BW=43.9MiB/s (46.0MB/s)(64.0MiB/1458msec); 0 zone resets
    clat (usec): min=3885, max=39145, avg=5300.13, stdev=3247.33
     lat (usec): min=4252, max=40936, avg=5691.08, stdev=3377.95
    clat percentiles (usec):
     |  1.00th=[ 3949],  5.00th=[ 4015], 10.00th=[ 4113], 20.00th=[ 4424],
     | 30.00th=[ 4555], 40.00th=[ 4686], 50.00th=[ 4817], 60.00th=[ 4948],
     | 70.00th=[ 5145], 80.00th=[ 5407], 90.00th=[ 5866], 95.00th=[ 6783],
     | 99.00th=[17171], 99.50th=[39060], 99.90th=[39060], 99.95th=[39060],
     | 99.99th=[39060]
   bw (  KiB/s): min=39424, max=46080, per=97.20%, avg=43690.67, stdev=3703.90, samples=3
   iops        : min=  154, max=  180, avg=170.67, stdev=14.47, samples=3
  lat (usec)   : 50=49.61%, 100=0.39%
  lat (msec)   : 4=1.95%, 10=46.68%, 20=0.98%, 50=0.39%
  cpu          : usr=13.12%, sys=10.85%, ctx=16560, majf=16384, minf=1046
  IO depths    : 1=100.0%, 2=0.0%, 4=0.0%, 8=0.0%, 16=0.0%, 32=0.0%, >=64=0.0%
     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
     issued rwts: total=256,256,0,0 short=0,0,0,0 dropped=0,0,0,0
     latency   : target=0, window=0, percentile=100.00%, depth=1

Run status group 0 (all jobs):
   READ: bw=500MiB/s (524MB/s), 500MiB/s-500MiB/s (524MB/s-524MB/s), io=64.0MiB (67.1MB), run=128-128msec
  WRITE: bw=43.9MiB/s (46.0MB/s), 43.9MiB/s-43.9MiB/s (46.0MB/s-46.0MB/s), io=64.0MiB (67.1MB), run=1458-1458msec

Disk stats (read/write):
  vdb: ios=15612/0, merge=0/0, ticks=1110/0, in_queue=1110, util=92.72%
Check conventional file mmap read
cnv_mmaprd: (g=0): rw=randread, bs=(R) 256KiB-256KiB, (W) 256KiB-256KiB, (T) 256KiB-256KiB, ioengine=mmap, iodepth=1
fio-3.32
Starting 1 process

cnv_mmaprd: (groupid=0, jobs=1): err= 0: pid=3422: Mon Jan 16 20:43:12 2023
  read: IOPS=179, BW=44.8MiB/s (47.0MB/s)(64.0MiB/1428msec)
    clat (usec): min=3775, max=39473, avg=5198.08, stdev=3246.90
     lat (usec): min=3776, max=39474, avg=5198.30, stdev=3246.99
    clat percentiles (usec):
     |  1.00th=[ 3884],  5.00th=[ 4015], 10.00th=[ 4113], 20.00th=[ 4359],
     | 30.00th=[ 4424], 40.00th=[ 4621], 50.00th=[ 4686], 60.00th=[ 4883],
     | 70.00th=[ 5014], 80.00th=[ 5211], 90.00th=[ 5735], 95.00th=[ 6718],
     | 99.00th=[20317], 99.50th=[38011], 99.90th=[39584], 99.95th=[39584],
     | 99.99th=[39584]
   bw (  KiB/s): min=37301, max=51712, per=96.98%, avg=44506.50, stdev=10190.12, samples=2
   iops        : min=  145, max=  202, avg=173.50, stdev=40.31, samples=2
  lat (msec)   : 4=3.12%, 10=94.92%, 20=0.78%, 50=1.17%
  cpu          : usr=7.99%, sys=9.04%, ctx=16410, majf=16384, minf=74
  IO depths    : 1=100.0%, 2=0.0%, 4=0.0%, 8=0.0%, 16=0.0%, 32=0.0%, >=64=0.0%
     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
     issued rwts: total=256,0,0,0 short=0,0,0,0 dropped=0,0,0,0
     latency   : target=0, window=0, percentile=100.00%, depth=1

Run status group 0 (all jobs):
   READ: bw=44.8MiB/s (47.0MB/s), 44.8MiB/s-44.8MiB/s (47.0MB/s-47.0MB/s), io=64.0MiB (67.1MB), run=1428-1428msec

Disk stats (read/write):
  vdb: ios=16006/0, merge=0/0, ticks=1127/0, in_queue=1127, util=93.32%
PASS

