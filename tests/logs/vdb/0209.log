## Test 0209: Conventional file mmap read/write (aggr_cnv)

/usr/local/bin/fio
Check conventional file mmap write (aggr_cnv)
/dev/vdb: 1572864 512-byte sectors (0 GiB)
  Host-managed device
  12 zones of 131072 512-byte sectors (64 MiB)
  6 conventional zones, 6 sequential zones
  0 read-only zones, 0 offline zones
Format:
  11 usable zones
  Aggregate conventional zones: enabled
  File UID: 0
  File GID: 0
  File access permissions: 640
  FS UUID: 15b892bb-e680-4b4b-8218-a6382f962564
Resetting sequential zones
Writing super block
cnv_mmapwr: (g=0): rw=randwrite, bs=(R) 256KiB-256KiB, (W) 256KiB-256KiB, (T) 256KiB-256KiB, ioengine=mmap, iodepth=1
fio-3.32
Starting 1 process

cnv_mmapwr: (groupid=0, jobs=1): err= 0: pid=3451: Mon Jan 16 20:43:21 2023
  read: IOPS=1990, BW=498MiB/s (522MB/s)(320MiB/643msec)
    clat (nsec): min=23147, max=69285, avg=26191.06, stdev=4119.69
     lat (nsec): min=23178, max=69313, avg=26241.98, stdev=4224.46
    clat percentiles (nsec):
     |  1.00th=[23424],  5.00th=[23680], 10.00th=[23936], 20.00th=[24192],
     | 30.00th=[24448], 40.00th=[24448], 50.00th=[24704], 60.00th=[25216],
     | 70.00th=[25728], 80.00th=[27008], 90.00th=[30080], 95.00th=[33024],
     | 99.00th=[45824], 99.50th=[49408], 99.90th=[64768], 99.95th=[69120],
     | 99.99th=[69120]
  write: IOPS=179, BW=44.8MiB/s (47.0MB/s)(320MiB/7141msec); 0 zone resets
    clat (usec): min=3863, max=40576, avg=5196.43, stdev=1828.80
     lat (usec): min=4230, max=42399, avg=5576.80, stdev=1893.39
    clat percentiles (usec):
     |  1.00th=[ 3916],  5.00th=[ 4080], 10.00th=[ 4228], 20.00th=[ 4490],
     | 30.00th=[ 4621], 40.00th=[ 4752], 50.00th=[ 4948], 60.00th=[ 5080],
     | 70.00th=[ 5407], 80.00th=[ 5604], 90.00th=[ 5997], 95.00th=[ 6915],
     | 99.00th=[ 8717], 99.50th=[10028], 99.90th=[38011], 99.95th=[40633],
     | 99.99th=[40633]
   bw (  KiB/s): min=13824, max=51712, per=95.21%, avg=43690.67, stdev=9386.45, samples=15
   iops        : min=   54, max=  202, avg=170.67, stdev=36.67, samples=15
  lat (usec)   : 50=49.77%, 100=0.23%
  lat (msec)   : 4=1.25%, 10=48.48%, 20=0.16%, 50=0.12%
  cpu          : usr=12.81%, sys=10.56%, ctx=82485, majf=81920, minf=5165
  IO depths    : 1=100.0%, 2=0.0%, 4=0.0%, 8=0.0%, 16=0.0%, 32=0.0%, >=64=0.0%
     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
     issued rwts: total=1280,1280,0,0 short=0,0,0,0 dropped=0,0,0,0
     latency   : target=0, window=0, percentile=100.00%, depth=1

Run status group 0 (all jobs):
   READ: bw=498MiB/s (522MB/s), 498MiB/s-498MiB/s (522MB/s-522MB/s), io=320MiB (336MB), run=643-643msec
  WRITE: bw=44.8MiB/s (47.0MB/s), 44.8MiB/s-44.8MiB/s (47.0MB/s-47.0MB/s), io=320MiB (336MB), run=7141-7141msec

Disk stats (read/write):
  vdb: ios=81920/624, merge=0/0, ticks=5786/285, in_queue=6071, util=93.85%
Check conventional file mmap read (aggr_cnv)
cnv_mmaprd: (g=0): rw=randread, bs=(R) 256KiB-256KiB, (W) 256KiB-256KiB, (T) 256KiB-256KiB, ioengine=mmap, iodepth=1
fio-3.32
Starting 1 process

cnv_mmaprd: (groupid=0, jobs=1): err= 0: pid=3467: Mon Jan 16 20:43:28 2023
  read: IOPS=185, BW=46.5MiB/s (48.7MB/s)(320MiB/6884msec)
    clat (usec): min=3834, max=13438, avg=5010.75, stdev=821.36
     lat (usec): min=3834, max=13440, avg=5010.96, stdev=821.37
    clat percentiles (usec):
     |  1.00th=[ 3982],  5.00th=[ 4146], 10.00th=[ 4293], 20.00th=[ 4490],
     | 30.00th=[ 4555], 40.00th=[ 4686], 50.00th=[ 4817], 60.00th=[ 4948],
     | 70.00th=[ 5211], 80.00th=[ 5473], 90.00th=[ 5800], 95.00th=[ 6259],
     | 99.00th=[ 8455], 99.50th=[ 8717], 99.90th=[ 9503], 99.95th=[13435],
     | 99.99th=[13435]
   bw (  KiB/s): min=43520, max=51712, per=99.95%, avg=47576.62, stdev=2563.94, samples=13
   iops        : min=  170, max=  202, avg=185.85, stdev=10.02, samples=13
  lat (msec)   : 4=1.33%, 10=98.59%, 20=0.08%
  cpu          : usr=7.03%, sys=9.57%, ctx=82116, majf=81920, minf=75
  IO depths    : 1=100.0%, 2=0.0%, 4=0.0%, 8=0.0%, 16=0.0%, 32=0.0%, >=64=0.0%
     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
     issued rwts: total=1280,0,0,0 short=0,0,0,0 dropped=0,0,0,0
     latency   : target=0, window=0, percentile=100.00%, depth=1

Run status group 0 (all jobs):
   READ: bw=46.5MiB/s (48.7MB/s), 46.5MiB/s-46.5MiB/s (48.7MB/s-48.7MB/s), io=320MiB (336MB), run=6884-6884msec

Disk stats (read/write):
  vdb: ios=79127/0, merge=0/0, ticks=5405/0, in_queue=5406, util=98.56%
PASS

